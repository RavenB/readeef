{% define "content" %}
<link rel="import" href="/dist/polymer/polymer.html">
<link rel="import" href="/dist/core-list/core-list.html">

<polymer-element name="rf-content-list" attributes="wide user feed feeds">
    <template bind="{{ wide as wide }}">
        <style>
            core-list .article {
                height: 36px;
                white-space: nowrap;
                text-overflow: ellipsis;
                overflow: hidden;
                overflow: hidden;
                padding: 8px 24px;
                box-sizing: border-box;
            }

            .article .title {
                font-size: 14px;
                line-height: 20px;
            }

            .article.selected .title {
                font-weight: bold;
            }

            .article .short-description {
                font-size: 10px;
                line-height: 20px;
                padding-left: 1em;
                font-weight: 200;
            }

            .article .feed-origin {
                font-size: 8px;
                line-height: 20px;
                font-weight: 200;
                padding-right: 1em;
            }

        </style>
        <core-list data="{{ articles }}" height="36" id="articles-list" on-core-activate="{{ onArticleActivate }}">
            <template>
                <div class="article {{ {selected: selected, read: Read, favorite: Favorite} | tokenList }}" id="{{ Id }}" layout horizontal>
                    <span class="feed-origin" hidden?="{{ !FeedOrigin }}">{{ FeedOrigin }}</span>
                    <span flex class="title">
                        {{ Title }}
                        <span flex class="short-description">{{ ShortDescription }}</span>
                    </span>
                </div>
            </template>
        </core-list>
    </template>
    <script>
(function() {
    "use strict";

    Polymer('rf-content-list', {
        created: function() {
            this.articles = [];
        },

        feedChanged: function(oldValue, newValue) {
            var self = this;

            if (newValue.Articles) {
                var worker = new Worker('/js/content-articles-worker.js'),
                    data = {current: newValue};

                worker.addEventListener('message', function(event) {
                    self.articles = event.data.articles;
                });
                if (newValue.Id == "__all__") {
                    data.feeds = this.feeds;
                }
                worker.postMessage(data);
            }
        },

        onArticleActivate: function(event, detail) {
            console.log(detail);
        }
    });
})();
    </script>
</polymer-element>
{% end %}
