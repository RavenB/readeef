{% define "content" %}
<link rel="import" href="/dist/polymer/polymer.html">
<link rel="import" href="/dist/core-list/core-list.html">
<link rel="import" href="/dist/core-animated-pages/core-animated-pages.html">
<link rel="import" href="/dist/core-animated-pages/transitions/slide-down.html">
<link rel="import" href="/dist/core-signals/core-signals.html">

<link rel="import" href="/dist/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/dist/paper-button/paper-button.html">

<link rel="import" href="/dist/loading-wave/loading-wave.html">

<link rel="import" href="/component/rf-api">
<link rel="import" href="/component/rf-button-link">
<link rel="import" href="/component/rf-article-display">

<polymer-element name="rf-content-list" attributes="wide user feed feeds article">
    <template bind="{{ wide as wide }}">
        <link href="/css/rf-content-list.css" rel="stylesheet">

        <core-animated-pages id="pages" class="{{ {wide: wide} | tokenList }}" selected="list" transitions="{{ wide ? 'slide-down' : ''}}" on-keypress="{{ onContentKeypress }}">

            <section name="list">
                <core-list data="{{ articles }}" height="{{ itemHeight }}" id="articles-list" on-core-activate="{{ onArticleActivate }}">
                    <template>
                        <div class="article {{ {selected: selected, read: Read, favorite: Favorite} | tokenList }}" id="{{ Id }}">
                            <div class="card" layout vertical slide-down?="{{ selected }}">
                                <div layout horizontal>
                                    <paper-icon-button class="favorite-button" icon="{{ {'bookmark-outline': !Favorite, bookmark: Favorite} | tokenList }}" on-tap="{{ onFavoriteToggle }}" data-article-id="{{ Id }}" data-feed-id="{{ FeedId }}"></paper-icon-button>
                                    <span class="feed-origin" title="{{ FeedOrigin }}" hidden?="{{ !FeedOrigin }}">{{ FeedOrigin }}</span>
                                    <span flex class="title-wrapper">
                                        <span class="title" title="{{ Title }}">{{ Hit && Hit.fragments.Title ? Hit.fragments.Title : Title }}</span>
                                        <span class="short-description">{{ Hit && Hit.fragments.Description ? Hit.fragments.Description : ShortDescription }}</span>
                                    </span>
                                    <span class="publish-date">{{ RelativeDate }}</span>
                                </div>
                            </div>
                        </div>
                    </template>
                </core-list>
            </section>

            <section name="detail" hidden?="{{ !article }}">
                <rf-article-display id="article-display" articles="{{ articles }}" article="{{ article }}" wide="{{ wide }}" user="{{ user }}">
                    <template>
                        <div class="article-detail">
                            <div class="card" layout vertical  slide-down?="{{ selected }}">
                                <div layout horizontal class="article-header">
                                    <paper-icon-button class="favorite-button" icon="{{ {'bookmark-outline': !Favorite, bookmark: Favorite} | tokenList }}" on-tap="{{ onFavoriteArticleToggle }}" data-article-id="{{ Id }}"></paper-icon-button>
                                    <span class="feed-origin" title="{{ FeedOrigin }}" hidden?="{{ !FeedOrigin }}" style="float: left">{{ FeedOrigin }}</span>
                                    <span flex class="title-wrapper" layout vertical>
                                        <a href="{{ Link }}" target="feed-article-{{ Id }}">
                                            <span class="title" title="{{ Title }}">{{ Title }}</span>
                                        </a>
                                        <span layout horizontal class="article-narrow-header-details">
                                            <span class="feed-origin" title="{{ FeedOrigin }}" hidden?="{{ !FeedOrigin }}" style="float: left">{{ FeedOrigin }}</span>
                                            <span class="publish-date">{{ RelativeDate }}</span>
                                        </span>
                                    </span>
                                    <span class="publish-date">{{RelativeDate}}</span>
                                </div>
                                <div class="article-content">
                                    <div class="article-description"></div>

                                    <div layout horizontal class="article-buttons">
                                        <rf-button-link href="{{ Link }}" target="feed-article-{{ Id }}" label="View the article" flex class="article-link"></rf-button-link>
                                        {% if ne .base.readeefConfig.ArticleFormatter.ReadabilityKey `` %}
                                            <paper-button label="Format" flex?="{{ wide }}" on-tap="{{ onArticleFormat }}" hidden?="{{ formatting || formatted }}"></paper-button>
                                            <template if="{{ formatting }}">
                                                <div layout vertical center flex?="{{ wide }}">
                                                    <loading-wave background="transparent"></loading-wave>
                                                </div>
                                            </template>
                                        {% end %}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </template>
                </rf-article-display>
            </section>

        </core-animated-pages>

        <rf-api id="article-read" method="post" pathAction="article/read/{{ article.FeedId }}/{{ article.Id }}/{{ articleRead }}" on-rf-api-response="{{ onArticleReadResponse }}" user="{{ user }}"></rf-api>
        <rf-api id="article-favorite" method="post" pathAction="article/favorite/{{ article.FeedId }}/{{ article.Id }}/{{ article.Favorite }}" on-rf-api-response="{{ onArticleFavoriteResponse }}" user="{{ user }}"></rf-api>

        <core-signals on-core-signal-rf-read-article-toggle="{{ onReadArticleToggle }}"></core-signals>
        <core-signals on-core-signal-rf-next-article="{{ nextArticle }}"></core-signals>
        <core-signals on-core-signal-rf-previous-article="{{ previousArticle }}"></core-signals>
    </template>

    <script src="/js/rf-content-list.js"></script>
</polymer-element>
{% end %}
